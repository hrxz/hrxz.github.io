<!DOCTYPE html>
<html>
<head>
 <meta charset="utf-8″>
   <meta name="description" content="<p>之前网上有很多的方法，但是测试发现基本上都已经失效了！今天给大家带来目前来说最好用的方法，用宏删除Excel保护密码(会直接弹出密码)， 亲测有效！</p>
" />
<link rel="shortcut icon" href="https://blog.hrxz.net/favicon.ico" type="image/x-icon" />
<meta name="viewport"content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
<meta name="apple-mobile-web-app-capable"content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style"content="black"/>
<meta name="format-detection"content="telephone=no"/>
<meta name="renderer"content="webkit">
<meta name="description"content="浩然小站,个人站点,记录个人点滴,">
<meta charset="UTF-8">
<title>破解Excel工作表保护密码，亲测有效 | 浩然小站</title>
<link href="https://blog.hrxz.net/styles/main.css" type="text/css" rel="stylesheet" />
<link href="https://at.alicdn.com/t/font_1621793_zatzzgvf30g.css" type="text/css" rel="stylesheet" />
<script async src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.min.js"></script>
<script src="https://blog.hrxz.net/media/js/magnify.min.js"></script>
<script type="text/javascript">function btn_toggle(){document.getElementById("hn").classList.contains("no-js")?document.getElementById("hn").classList.remove("no-js"):document.getElementById("hn").classList.add("no-js")}</script>

<link rel="canonical" href="https://blog.hrxz.net/post/password/" />
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>	
</head>
<body>
<div class="progress"></div><style>.progress{background:linear-gradient(to right,#87ceeb var(--scroll),transparent 0);background-repeat:no-repeat;position:fixed;width:100%;height:4px;z-index:1}</style><div class="darkmode-background"></div><div class="darkmode-layer"></div>
<noscript><p class="warn" >本页面需要浏览器支持（启用）JavaScript</p></noscript><div class="header"><div class="logo_title"><div class="title animated fadeInDown"><a href="https://blog.hrxz.net"><img alt="logo" style="display:inline-block;" src="https://blog.hrxz.net/images/avatar.png"/></a><h1 title="浩然小站" class="weaklink shift"><a  href="/">浩然小站</a></h1>

<div class="navbar weaklink">
<div class="normal_nav">
<div class="bitcron_nav_container"><div class="bitcron_nav"><div class="bitcron_nav"><div style="display:flex;justify-content:center;"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >首页</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tag/phone/" class="selected active current nav__item" >安卓</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tag/dianqi/" class="selected active current nav__item" >电气</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tag/computer/" class="selected active current nav__item" >电脑</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tag/dianshang/" class="selected active current nav__item" >电商</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://a.hrxz.net" class="selected active current nav__item" >导航</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://www.hrxz.net/archives" class="selected active current nav__item" >归档</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >关于</a></li></ul></nav>
<div style="float:right;margin-top:1em"><form id="gridea-search-form" data-update="1578893743252" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="Search..."></form></div><div style="margin-left:0.5em;margin-top:1.2em"><input id="switch_default" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
<div class="clear clear_nav_inline_end"></div></div></div><div class="clear clear_nav_end"></div></div></div><div class="hamberger" href="javascript:void(0)" onclick="btn_toggle();"><i class="iconfont icon-category"></i></div></div></div></div>
<div id="hn" class="no-js hidden_nav animated fadeInDown"><div class="bitcron_nav_container"><div class="bitcron_nav"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >首页</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tag/phone/" class="selected active current nav__item" >安卓</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tag/dianqi/" class="selected active current nav__item" >电气</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tag/computer/" class="selected active current nav__item" >电脑</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tag/dianshang/" class="selected active current nav__item" >电商</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://a.hrxz.net" class="selected active current nav__item" >导航</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://www.hrxz.net/archives" class="selected active current nav__item" >归档</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >关于</a></li></ul><div class="clear clear_nav_inline_end"></div></nav></div><div class="clear clear_nav_end"></div></div>
<div style="display:flex;justify-content:center;inline-block;text-align:center;margin-top:7%"><div><form id="gridea-search-form" data-update="1651665528206" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q"  placeholder="Search..." /></form></div><div style="margin-left:0.5em"><input id="switch_default_h" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
</div></div>
<script>function enableDarkmode(){document.body.classList.add("darkmode"),document.getElementById("switch_default").checked=1,document.getElementById("switch_default_h").checked=1}function removeDarkmode(){document.body.classList.remove("darkmode"),document.getElementById("switch_default").checked=0,document.getElementById("switch_default_h").checked=0}function getCookie(a){var b,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)");return(b=document.cookie.match(c))?unescape(b[2]):null}cookie=getCookie("darkmode"),"enable"==cookie&&enableDarkmode(),window.matchMedia("(prefers-color-scheme: dark)").matches&&"disable"!==cookie&&(enableDarkmode(),document.cookie="darkmode=enable; path=/");var mobileBtn=function(){1==document.getElementById("switch_default").checked?(enableDarkmode(),document.cookie="darkmode=enable; path=/"):(removeDarkmode(),document.cookie="darkmode=disable; path=/")};</script>

<div class="main"><div class="main-inner"><div class="content">
<article class="post">
<h2 class="post_title sm_margin"><a>破解Excel工作表保护密码，亲测有效</a></h2>
<br>
<script>function lan(){if(document.getElementById("lan").innerText=="繁"){var s=document.getElementById("tongwenlet_cn");if(s!=null){document.body.removeChild(s)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.src="https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_tw.js";s.id="tongwenlet_cn";document.body.appendChild(s);document.getElementById("lan").innerHTML="简"}else{if(document.getElementById("lan").innerText=="簡"){var s=document.getElementById("tongwenlet_cn");if(s!=null){document.body.removeChild(s)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.src="https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_cn.js";s.id="tongwenlet_cn";document.body.appendChild(s);document.getElementById("lan").innerHTML="繁"}}};</script>
<section class="post_details"><i class="iconfont icon-calendar"></i><span style="margin-right:15px"> 2021-07-28</span></span> </span>分类：<span class="weaklink" style="margin-right:15px">	<a href="https://blog.hrxz.net/tag/computer/" class="tag">电脑</a></span>字数：<span style="margin-right:15px">1213字</span><i class="iconfont icon-naozhong"></i><span style="margin-right:15px">7 min read</span><a id="lan" href="javascript:void(0);"onclick="lan();"title="调整简繁体" style="margin-right:15px;">繁</a>
</section>

<div style="display:flex">
<div class="md_block" id="md_block">

<p>之前网上有很多的方法，但是测试发现基本上都已经失效了！今天给大家带来目前来说最好用的方法，用宏删除Excel保护密码(会直接弹出密码)， 亲测有效！</p>
<!-- more -->
<p>1.既然要用到宏肯定要先启动宏咯，依次打开“文件→选项→信任中心→信任中心设置→宏设置→启动所有宏”<br>
<img src="https://blog.hrxz.net/post-images/1627479663250.png" alt="" loading="lazy"></p>
<p>2.先打开需要删除保护密码的工作表，再新建一个工作簿，在视图界面打开宏-录制宏，宏名随便填，保存在当前工作簿-确认，再打开宏，停止录制。<br>
<img src="https://blog.hrxz.net/post-images/1627479782958.png" alt="" loading="lazy"><br>
3.Alt+F11打开VBA界面，双击打开ThisWorkbook输入框，并把下面的代码复制进去，可以查看到是没有报错的，保存。<br>
<img src="https://blog.hrxz.net/post-images/1627480094378.png" alt="" loading="lazy"><br>
<b>需要复制的代码：</b></p>
<pre><code>Public Sub 工作表保护密码()
Const DBLSPACE As String = vbNewLine &amp; vbNewLine
Const AUTHORS As String = DBLSPACE &amp; vbNewLine
Const HEADER As String = &quot;工作表保护密码&quot;
Const VERSION As String = DBLSPACE &amp; &quot;版本 Version 1.1.2&quot;
Const REPBACK As String = DBLSPACE &amp; &quot;&quot;
Const ZHENGLI As String = DBLSPACE &amp; &quot; &quot;
Const ALLCLEAR As String = DBLSPACE &amp; &quot;该工作簿中的工作表密码保护已全部解除。&quot; &amp; DBLSPACE &amp; &quot;请记得重新设置密码&quot; _
&amp; DBLSPACE &amp; &quot;注意：此方法仅用于遗忘密码使用。&quot;
Const MSGNOPWORDS1 As String = &quot;该文件工作表中没有加密&quot;
Const MSGNOPWORDS2 As String = &quot;该文件工作表中没有加密2&quot;
Const MSGTAKETIME As String = &quot;请耐心等候!&quot; &amp; DBLSPACE &amp; &quot;按确定开始回复&quot;
Const MSGPWORDFOUND1 As String = &quot;工作表保护密码:&quot; &amp; DBLSPACE &amp; &quot;$$&quot; &amp; DBLSPACE &amp; _
&quot;如果该文件工作表有不同密码,将搜索下一组密码并修改清除&quot;
Const MSGPWORDFOUND2 As String = &quot;工作表保护密码:&quot; &amp; DBLSPACE &amp; &quot;$$&quot; &amp; DBLSPACE &amp; _
&quot;如果该文件工作表有不同密码,将搜索下一组密码并解除&quot;
Const MSGONLYONE As String = &quot;确保为唯一的?&quot;
Dim w1 As Worksheet, w2 As Worksheet
Dim i As Integer, j As Integer, k As Integer, l As Integer
Dim m As Integer, n As Integer, i1 As Integer, i2 As Integer
Dim i3 As Integer, i4 As Integer, i5 As Integer, i6 As Integer
Dim PWord1 As String
Dim ShTag As Boolean, WinTag As Boolean
Application.ScreenUpdating = False
With ActiveWorkbook
WinTag = .ProtectStructure Or .ProtectWindows
End With
ShTag = False
For Each w1 In Worksheets
ShTag = ShTag Or w1.ProtectContents
Next w1
If Not ShTag And Not WinTag Then
MsgBox MSGNOPWORDS1, vbInformation, HEADER
Exit Sub
End If
MsgBox MSGTAKETIME, vbInformation, HEADER
If Not WinTag Then
Else
On Error Resume Next
Do 'dummy do loop
For i = 65 To 66: For j = 65 To 66: For k = 65 To 66
For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66
For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66
For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126
With ActiveWorkbook
.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _
Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; _
Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)
If .ProtectStructure = False And _
.ProtectWindows = False Then
PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _
Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _
Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)
MsgBox Application.Substitute(MSGPWORDFOUND1, _
&quot;$$&quot;, PWord1), vbInformation, HEADER
Exit Do 'Bypass all for…nexts
End If
End With
Next: Next: Next: Next: Next: Next
Next: Next: Next: Next: Next: Next
Loop Until True
On Error GoTo 0
End If

If WinTag And Not ShTag Then
MsgBox MSGONLYONE, vbInformation, HEADER
Exit Sub
End If
On Error Resume Next

For Each w1 In Worksheets
'Attempt clearance with PWord1
w1.Unprotect PWord1
Next w1
On Error GoTo 0
ShTag = False
For Each w1 In Worksheets
'Checks for all clear ShTag triggered to 1 if not.
ShTag = ShTag Or w1.ProtectContents
Next w1
If ShTag Then
For Each w1 In Worksheets
With w1
If .ProtectContents Then
On Error Resume Next
Do 'Dummy do loop
For i = 65 To 66: For j = 65 To 66: For k = 65 To 66
For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66
For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66
For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126
.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _
Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _
Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)
If Not .ProtectContents Then
PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _
Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _
Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)
MsgBox Application.Substitute(MSGPWORDFOUND2, _
&quot;$$&quot;, PWord1), vbInformation, HEADER
'leverage finding Pword by trying on other sheets
For Each w2 In Worksheets
w2.Unprotect PWord1
Next w2
Exit Do 'Bypass all for…nexts
End If
Next: Next: Next: Next: Next: Next
Next: Next: Next: Next: Next: Next
Loop Until True
On Error GoTo 0
End If
End With
Next w1
End If
MsgBox ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK &amp; ZHENGLI, vbInformation, HEADER
End Sub
</code></pre>
<p>4.打开需要删除保护密码的工作表，在视图界面打开宏-查看宏-宏名选择“ThisWorkbook-工作表保护密码”，位置选择你需要打开删除保护密码的工作表，再点击&quot;执行&quot;，宏就可以跑起来了接着按照提示点就行啦!如果电脑配置一般，会卡死，耐心等待一下就行！会直接弹出密码!如下图如示：<br>
<img src="https://blog.hrxz.net/post-images/1627480568080.png" alt="" loading="lazy"></p>
<figure data-type="image" tabindex="1"><img src="https://blog.hrxz.net/post-images/1627481692951.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="2"><img src="https://blog.hrxz.net/post-images/1627481699218.png" alt="" loading="lazy"></figure>

<span id="footnote"></span>
<div id = "warn"></div>
</div>
<div class="toc-container"></div>
</div>
<div id="fullPage"><canvas id="canvas"></canvas></div>
</article>
<hr>
<section><div style="color:#ccc;font-size:12px;width:100%;">上一篇&nbsp;<a href="https://blog.hrxz.net/post/20/"><b>手机免ROOT为微信安装微X模块，以实现抢红包与消息防撤回功能</b></a></div><div style="color:#ccc;font-size:12px;width:100%;">下一篇&nbsp;<a href="https://blog.hrxz.net/post/19/"><b>18个问答彻底讲明白RS485</b></a></div></section>
<hr>
<!--PC和WAP自适应版-->
<div id="SOHUCS" ></div> 
<script type="text/javascript"> 
(function(){ 
var appid = 'cyw0B3XaW'; 
var conf = 'prod_65262f9e55147a7ee6cea204f0d9b9d6'; 
var width = window.innerWidth || document.documentElement.clientWidth; 
if (width < 1000) {
var head = document.getElementsByTagName('head')[0]||document.head||document.documentElement;
var script = document.createElement('script');
script.type = 'text/javascript';
script.charset = 'utf-8';
script.id = 'changyan_mobile_js';
script.src = 'https://cy-cdn.kuaizhan.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf;
head.appendChild(script);
} else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://cy-cdn.kuaizhan.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>
</div></div></div>
<style>#magnifyImg{position:fixed;left:0;top:0;text-align:center;width:100%;display:none;z-index:9999}#magnifyImg img{object-fit:contain;background:#eaecef;padding:15px;border-radius:10px;height:auto;width:auto;vertical-align:middle}</style>
<div class="footer animated fadeInDown"><div class="site_footer"><div class="mysocials"><div class="my_socials"></div></div><div class="copyright"id="copyright">Copyright © 2019-2022<a href="https://www.hrxz.net/" >浩然小站</a><br><a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=7dvlhy3n">服务器托管在：阿里云</a><br><a href="http://beian.miit.gov.cn/" >豫ICP备18044147号</a></div>
</div></div>
<script>
console.log("\n %c \u26a1Theme: Bitcron-pro Author's Blog:https://blog.blinkstar.cn  Writen By Serence  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;", );
</script>
<script src="https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js" type="module" defer></script>

</body>
</html>